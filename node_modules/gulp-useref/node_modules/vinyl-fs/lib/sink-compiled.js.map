{"version":3,"sources":["sink.js"],"names":[],"mappings":"AAAA;;AAEA,IAAI,WAAW,QAAQ,0BAAR,CAAf;;AAEA,SAAS,aAAT,CAAuB,MAAvB,EAA+B,GAA/B,EAAoC;AAClC,SAAO,OAAO,SAAP,CAAiB,GAAjB,EAAsB,MAA7B;AACD;;AAED,SAAS,YAAT,CAAsB,MAAtB,EAA8B;AAC5B,SAAO,CAAC,EAAE,cAAc,MAAd,EAAsB,UAAtB,KAAqC,cAAc,MAAd,EAAsB,MAAtB,CAAvC,CAAR;AACD;;AAED,SAAS,IAAT,CAAc,MAAd,EAAsB;AACpB,MAAI,YAAY,KAAhB;AACA,MAAI,aAAa,IAAI,QAAJ,CAAa;AAC5B,gBAAY,IADgB;AAE5B,WAAO,eAAS,IAAT,EAAe,GAAf,EAAoB,EAApB,EAAwB;AAC7B;AACD;AAJ2B,GAAb,CAAjB;;AAOA,WAAS,OAAT,GAAmB;AACjB,QAAI,SAAJ,EAAe;AACb;AACD;;AAED,QAAI,aAAa,MAAb,CAAJ,EAA0B;AACxB;AACD;;AAED,gBAAY,IAAZ;AACA,WAAO,IAAP,CAAY,UAAZ;AACD;;AAED,WAAS,UAAT,CAAoB,GAApB,EAAyB;AACvB,QAAI,QAAQ,UAAR,IAAsB,QAAQ,MAAlC,EAA0C;AACxC;AACD;;AAED,QAAI,aAAa,MAAb,CAAJ,EAA0B;AACxB,kBAAY,KAAZ;AACA,aAAO,MAAP,CAAc,UAAd;AACD;AACF;;AAED,SAAO,EAAP,CAAU,aAAV,EAAyB,UAAzB;AACA,SAAO,EAAP,CAAU,gBAAV,EAA4B,UAA5B;AACA,SAAO,EAAP,CAAU,gBAAV,EAA4B,OAA5B;;AAEA,SAAO,OAAP;AACD;;AAED,OAAO,OAAP,GAAiB,IAAjB","file":"sink-compiled.js","sourcesContent":["'use strict';\n\nvar Writable = require('readable-stream/writable');\n\nfunction listenerCount(stream, evt) {\n  return stream.listeners(evt).length;\n}\n\nfunction hasListeners(stream) {\n  return !!(listenerCount(stream, 'readable') || listenerCount(stream, 'data'));\n}\n\nfunction sink(stream) {\n  var sinkAdded = false;\n  var sinkStream = new Writable({\n    objectMode: true,\n    write: function(file, enc, cb) {\n      cb();\n    },\n  });\n\n  function addSink() {\n    if (sinkAdded) {\n      return;\n    }\n\n    if (hasListeners(stream)) {\n      return;\n    }\n\n    sinkAdded = true;\n    stream.pipe(sinkStream);\n  }\n\n  function removeSink(evt) {\n    if (evt !== 'readable' && evt !== 'data') {\n      return;\n    }\n\n    if (hasListeners(stream)) {\n      sinkAdded = false;\n      stream.unpipe(sinkStream);\n    }\n  }\n\n  stream.on('newListener', removeSink);\n  stream.on('removeListener', removeSink);\n  stream.on('removeListener', addSink);\n\n  return addSink;\n}\n\nmodule.exports = sink;\n"]}