!function(){$.fn.menu=function(t){new NavBar(t)},$(function(){var t=function(){var t=UrlUtil.getQueryString("from"),e=UrlUtil.getQueryString("active"),a=function(t){if(-1!=window.location.href.indexOf("index.html"))return!1;if(t.length){var e=t.parent();if(e&&"side-menu"!==e.attr("id")){if(e.is("li")){e.addClass("active");var n=e.children("a");n.length>0&&s.push(n)}else e.addClass("in");a(e)}}},n=function(){XREWIN.setActiveHref(this,t)},o=function(){var t=$(this),e=t.attr("href");if(e){var a=t.attr("name");e=XREWIN.appendParam(e,"sid",u),e=XREWIN.appendParam(e,"from",a),t.attr("href",e)}},i=$("#side-menu"),l=$(".header_li"),d=$("#logoutForm"),s=[],r=$("#page_title"),c=$("#page_breadcrumb"),u=XREWIN.getSid();if(XREWIN.hasLogined()){e&&""!=e&&s.push($(Base64.decode(e))),d.attr("action",XREWIN.getLogoutAction()),i.find("a").each(o),l.find("a").each(o);var p=t,v=i.find("a.menu-anchor[name='"+p+"']");0==v.length&&(v=i.find(".menu-anchor").first()),r.text(v.text()),a(v),c.find("a").each(o);for(var m=s.length;m>0;m--){var f=s[m-1],b=$.trim(f.attr("title"));b||(b=$.trim(f.text()));var h=document.createElement("li");if(m>1){var g=document.createElement("a"),T=f.attr("href");T&&g.setAttribute("href",T),g.innerHTML=b,h.appendChild(g)}else{var C=document.createElement("strong");C.innerHTML=b,h.className="active",h.appendChild(C)}c.append(h)}$("a[name=addSidHref]").each(n),$("#btnChangePassword").popup({title:TxtContent.pwd.mod,elements:[{require:!0,labelName:TxtContent.pwd.old,type:"text",name:"oldPassword"},{require:!0,labelName:TxtContent.pwd["new"],type:"text",name:"newPassword"},{require:!0,labelName:TxtContent.pwd.repeat,type:"text",name:"confirmPassword",validators:{equal:{message:TxtContent.pwd.match,field:"newPassword"}}}],submitBindFunc:function(){alert("modal_1111！")},clear:!0}),$("#btnLogoutForm").on("click",function(){document.getElementById("logoutForm").submit()})}};t(),$("#side-menu").find(".showLi:last .menu-anchor").on("click",function(){localStorage.lang=$(this).attr("name"),$("#content_breadcrumb").hide()})})}(),function(t,e,a,n){t.fn.smartGroupFilter=function(e){var n=this,o={};o=e&&e.smartGroup?t.extend({},e.smartGroup.options,e):t.extend({},e),n.options=o;var i=MemberFilters,l=function(t,e,a){return"undefined"==typeof t||"undefined"==typeof t[e]?a:t[e]},d=function(e,a){var n='<input class="inputBox validator" type="text" value=""  name="content">',o='<input class="numberBox validator" type="number" value="" min="0" name="content">',i='<input class="beginNumber validator" type="number">-<input class="endNumber validator" type="number">',l='<input class="dataBox validator" type="date" value="" name="content">',d='<input class="beginData validator" type="date" value="" name="beginTime">-<input class="endData validator" type="date" value="" name="endTime">',s='<select name="operate" class="operate"><option value="like">'+TxtContent.like+'</option><option value="notLike">'+TxtContent.noLike+'</option><option value="equal">'+TxtContent.equal+'</option><option value="notEqual">'+TxtContent.noEqual+"</option></select>",r='<select name="operate" class="operate"><option value="in">'+TxtContent["in"]+'</option><option value="notIn">'+TxtContent.noIn+"</option></select>",c='<select name="operate" class="operate"><option value="equal">'+TxtContent.equal+'</option><option value="lessThan">'+TxtContent.lessThan+'</option><option value="moreThan">'+TxtContent.moreThan+'</option><option value="moreThanOrEqual">'+TxtContent.moreThanOrEqual+'</option><option value="lessThanOrEqual">'+TxtContent.lessThanOrEqual+"</option></select>",u='<select class="operate timeType"><option value="year">'+TxtContent.year+'</option><option value="month">'+TxtContent.month+'</option><option value="day">'+TxtContent.day+'</option><option value="hour">'+TxtContent.hour+"</option></select>",p='<select class="operate validator actionType"><option value="">'+TxtContent.sel+'</option><option value="sms">'+TxtContent.sms+'</option><option value="email">'+TxtContent.mail+'</option></select><select class="behavior operate validator action"><option value="">'+TxtContent.sel+"</option></select>",v="";switch(e.type){case CONTENT_TYPE.INPUT:v=s+n;break;case CONTENT_TYPE.LIST:r+='<span class="select-group">',t.each(e.urls,function(t,e){r+='<select data-type="'+e.type+'" data-filter-name="'+encodeURIComponent(e.filter_name)+'" style="width:200px;display:block;" data-text="'+encodeURIComponent(e.text)+'" data-url="'+encodeURIComponent(e.url)+'" data-idname="'+e.idName+'" data-textname="'+e.textName+'" data-name="'+encodeURIComponent(e.name)+'" data-datacon='+JSON.stringify(e.dataCon)+"></select>"}),r+="</span>",v=r;break;case CONTENT_TYPE.SELECT:var m=t('<select style="width: 100%;padding: 4px;" name="'+e.name+'" class="selVal validator"><option value="">'+TxtContent.sel+"</option></select>");XREWIN.addOptions(e.dataCon,"value","text",m),v=m[0].outerHTML;break;case CONTENT_TYPE.NUMBER:v=c+o;break;case CONTENT_TYPE.NUMBER_RANGE:v=i;break;case CONTENT_TYPE.DATE:v=c+l;break;case CONTENT_TYPE.DATE_RANGE:v=d;break;case CONTENT_TYPE.RELATIVE_TIME:v='<input class="numberBox validator timeInterval" type="number" min="0">'+u;break;case CONTENT_TYPE.CASCADE:v=p}return'<form data-bv-message="This value is not valid" onkeydown="if(event.keyCode==13){return false;}"id="formData'+a+'" class="formAllData" data-contentType="'+e.type+'">'+v+'<input name="column" value="'+a+'" hidden></form>'},s=function(t){var e=l(t,"text","属性"),a='<div><div class="btn-group filter-types">';return a+='<button class="btn btn-success" data-iclass="fa-filter" title="'+TxtContent.filter+'"><i class="fa fa-filter"></i></button>',a+='<button class="btn btn-white" data-iclass="fa-plus" title="'+TxtContent.plus+'"><i class="fa fa-plus"></i></button>',a+='<button class="btn btn-white" data-iclass="fa-minus" title="'+TxtContent.minus+'"><i class="fa fa-minus"></i></button><span class="filterName">'+e+"</span></div>",a+='<div style="padding: 5px 0 10px;">',a+=d(t.content,t.column),a+="</div>",a+='<div class="sm-popover-buttons">',a+='<button class="btn btn-primary confirm">'+TxtContent.confirm+"</button>",a+='<button class="btn btn-white cancel">'+TxtContent.cancel+"</button>",a+="</div>"},r=function(t){for(var e="",a=0;a<t.buttons.length;a++){var n=t.buttons[a];e+='<button data-filter-table="'+n.table+'" data-filter-column="'+n.column+'" ',e+='class="btn btn-outline btn-white sm-row-button"',e+='data-container="body" data-toggle="popover" data-placement="auto bottom"',e+="data-content='"+s(n)+"'",e+='data-original-title="" title="">'+n.text+"</button>"}return e},c=function(t){var e='<tr class="popover-options">';return e+='<td style="vertical-align: text-top;"><label class="sm-row-name">'+t.name+"：</label></td><td>",e+=r(t),e+="</td></tr>"},u=function(t){return'<li><a data-toggle="tab" href="#'+t.value+'" aria-expanded="false">'+t.name+"</a></li>"},p=function(t){var e='<div id="'+t.value+'" class="tab-pane"><div class="panel-body sg-body">';return e+=r(t),e+="</div></div>"},v=function(e,a){var n=decodeURIComponent(e.data("url")),o=decodeURIComponent(e.data("filter-name")),i=e.data("datacon");if("undefined"!=o){var l=a.data("names");if(l)for(var d in l)d&&"string"==typeof d&&l.hasOwnProperty(d)&&(n=XREWIN.appendParam(n,d,l[d].join(",")));var s=XREWIN.getUrlParam("key");n=XREWIN.appendParam(n,"group_key",s)}var r=decodeURIComponent(e.data("text")),c=e.data("selected_data");"undefined"!=n?XREWIN.ajaxGetJsonByCache(n,null,function(n){e.off("select2:select select2:unselect"),e.empty();var i=DataUtil.selectData(n.data,e.data("idname"),e.data("textname"));if(e.select2({data:i,multiple:!0,placeholder:r,tag:!0}),o){if(c&&c.length>0){for(var l=[],d=0;d<c.length;d++)l.push(c[d].id);e.val(l).trigger("change")}e.on("select2:select select2:unselect",function(e){var n=t(this),i=a.data("names");i||(i={}),i[o]=[],t.each(n.select2("data"),function(t,e){i[o].push(e.id)}),a.data("names",i),n.data("selected_data",n.select2("data"));var l=n.nextAll("select");l.each(function(){var e=t(this);v(e,a)})})}}):i&&e.select2({data:i,multiple:!0,placeholder:r,tag:!0})},m=null,f=function(e){var l=n.options.scene;if("modal"==l){for(var d=t('<ul class="nav nav-tabs"></ul>'),s=t('<div class="tab-content"></div>'),r=0;r<i.length;r++)d.append(u(i[r])),s.append(p(i[r]));d.find("li:first").addClass("active").attr("aria-expanded",!0),s.find(".tab-pane:first").addClass("active");var f=t('<div class="tabs-container sg-tabs-container"></div>').append(d,s);t(n).append(f)}else for(var b=t(a.createElement("table")).appendTo(n),r=0;r<i.length;r++)t(c(i[r])).appendTo(b);var h=n.find("button").popover({html:!0,trigger:"click"}),g=function(){return null==m?void console.log("closePop.filtering is null"):(m.removeClass("btn-success").addClass("btn-white"),m.click(),void(m=null))};n.closePopFun=g,h.on("click",function(){t(this).attr("byClick")?(m=null,t(this).removeAttr("byClick")):t(this).attr("byClick","byClick")}),h.on("shown.bs.popover",function(){var i=t(this),l=i.data("filter-table"),d=i.data("filter-column");m&&(m.data("filter-table")==l&&m.data("filter-column")==d?console.debug("click same button"):(m.removeClass("btn-success").addClass("btn-white"),m.click())),m=i,i.removeClass("btn-white").addClass("btn-success");var s="fa-filter",r={iClass:s,table:l,column:d},c=i.data("bs.popover"),u=c.tip();return u.find(".actionType").on("change",function(){var e=u.find(".action");"sms"==t(this).val()?e.empty().append('<option value="sendSuccess">'+TxtContent.sendSuccess+'</option><option value="invalidTel">'+TxtContent.invalidTel+'</option><option value="click">'+TxtContent.click+"</option>"):"email"==t(this).val()&&e.empty().append('<option value="sendSuccess">'+TxtContent.sendSuccess+'</option><option value="open">'+TxtContent.open+'</option><option value="click">'+TxtContent.click+'</option><option value="filterCount">'+TxtContent.filterCount+'</option><option value="formatError">'+TxtContent.formatError+'</option><option value="onceSubmitRepeat">'+TxtContent.onceSubmitRepeat+'</option><option value="sendUnreg">'+TxtContent.sendUnreg+'</option><option value="sendInvalid">'+TxtContent.sendInvalid+'</option><option value="backEmail">'+TxtContent.backEmail+'</option><option value="emailAddressInvalid">'+TxtContent.emailAddressInvalid+'</option><option value="serverReject">'+TxtContent.serverReject+'</option><option value="unreg">'+TxtContent.unreg+"</option>")}),u.find(".select-group").each(function(){var e=t(this),a=e.find("select");a.each(function(){var a=t(this);v(a,e),u.find('select[name="operate"]').css("width","100%")})}),u.find(".cancel").unbind("click.smg.filter").bind("click.smg.filter",function(){g()}),u.find(".filter-types button").bind("click",function(){t(this).parent().find("button.btn-success").removeClass("btn-success").addClass("btn-white"),t(this).removeClass("btn-white").addClass("btn-success"),r.iClass=t(this).data("iclass")}),u.unbind("keydown").bind("keydown",function(t){13==event.keyCode&&(u.find(".confirm").trigger("click"),t.stopPropagation())}),u.find(".confirm").unbind("click.smg.filter").bind("click.smg.filter",function(){XREWIN.skipPrompt(TxtContent.skipPrompt);var i=u.find("form").attr("id"),d="",s=u.find("form");o.smartGroup&&(d=o.smartGroup.getFatherId());var c=s.attr("data-contentType"),p=new FormData(a.getElementById(i));p.append("tableName",l),p.append("relationType",r.iClass),p.append("type",c),p.append("groupKey",e);var v={mark:!0};switch(c){case"relative-time":v.timeInterval=u.find(".timeInterval").val(),v.timeType=u.find(".timeType").val(),delete v.mark;break;case"cascade":v.actionType=u.find(".actionType").val(),v.action=u.find(".action").val(),delete v.mark;break;case"number-range":v.beginNumber=u.find(".beginNumber").val(),v.endNumber=u.find(".endNumber").val(),delete v.mark}v.mark||p.append("content",JSON.stringify(v));var f=u.find(".filterName").text(),b=u.find('select[name="operate"]').find("option:selected").text(),h="";switch(c){case"input":var T=u.find(".inputBox").val();h+="<b>"+f+"</b><em>"+b+"</em>"+T;break;case"list":u.find(".select-group select").each(function(){for(var e=t(this),a=e.select2("data"),n=[],o=0;o<a.length;o++)n.push(a[o].text);if(n){var i=n.join("&&");h+="<b>"+decodeURIComponent(e.data("text"))+"</b><em>"+b+"</em>"+i+"<br/>"}});break;case"date":var C=u.find(".dataBox").val();h+="<b>"+f+"</b><em>"+b+"</em>"+C;break;case"date-range":var x=u.find(".beginData").val(),y=u.find(".endData").val();h+="<b>"+f+"</b><em>"+TxtContent.from+"</em>"+x+"<em>"+TxtContent.to+"</em>"+y;break;case"number":var k=u.find(".numberBox").val();h+="<b>"+f+"</b><em>"+b+"</em>"+k;break;case"select-str":var w=u.find(".selVal").val();h+="<b>"+f+"</b><em>"+TxtContent.be+"</em>"+w;break;case"relative-time":var I=u.find(".numberBox").val(),N=u.find(".timeType option:selected").text();h+="<b>"+f+"</b><em>"+TxtContent.be+"</em>"+I+N;break;case"cascade":var L=u.find(".actionType option:selected").text(),$=u.find(".action option:selected").text();h+="<b>"+f+"</b><em>"+L+"-</em>"+$;break;case"number-range":var E=u.find(".beginNumber").val(),S=u.find(".endNumber").val();h+="<b>"+f+"</b><em>"+TxtContent.from+"</em>"+E+"<em>"+TxtContent.to+"</em>"+S}var P,M={};if(u.find(".select-group select").each(function(){var e=t(this),a=e.data("name"),n=e.select2("val");n&&("int"==e.data("type")?P=n.join():"zone"==e.data("type")?(M[a]="'"+n.join("','")+"'",P=JSON.stringify(M)):P="'"+n.join("','")+"'")}),P&&p.append("content",P),"function"==typeof n.options.func){var D={iClass:r.iClass,text:h};return n.options.func(p,D),g(m),!1}if(XREWIN.loadingType="toast",XREWIN.loading)return!1;p.append("parentId",d||"parentId");var R=function(t){o.smartGroup&&o.smartGroup.addNode(t,function(){var t=this.split(",");o.smartGroup.addBlock({iClass:r.iClass,id:t[0],text:h,count:t[1]||-1})})},G=s.find(".validator").val(),O=s.find(".select2-selection__rendered").text();G?(R(p),g(m)):(s.find(".validator").css({border:"1px solid red","padding-left":"5px"}).attr("placeholder",TxtContent.dataIsNull),O?(R(p),g(m)):s.find(".select2-selection__rendered").text(TxtContent.dataIsNull).css("padding","5px")),XREWIN.loadingType=""}),i})};return f(n.options.groupKey||""),n}}(jQuery,window,document),function(t,e,a,n){var o,i={id:"parentId",iClass:"fa-users",isReadOnly:!0,index:0},l={id:"vertical-timeline-last",iClass:"fa-user",isReadOnly:!0,selectAble:!1},d=function(e){var a=this;return a.defaults={modalId:"smartGroupModal",modalTitle:TxtContent.smartGroup,modalWrapId:"smartGroupModalWrap",tableId:"sgTable",modalSaveId:"smartGroupModalSaveId",modalOkId:"smartGroupModalOkId",modalCancelId:"smartGroupModalCancelId",modalSave:TxtContent.save,modalOk:TxtContent.confirm,modalCancel:TxtContent.cancel,scene:"modal",extendData:{selectAble:!0,selected:!1,parentId:""},func:function(t,n){t.append("parentId",a.getParentId()),XREWIN.loadingType="toast",SMARTGROUP.addSmartGroupNode(t,function(){XREWIN.loadingType="";var t=this.data.split(",");"1"==t.code,n.count=t[1],n.id=t[0],o.row.add(n).draw(),(new d).smartGroupModalSave(e.groupKey)})}},a.options=t.extend({},a.defaults,e),a.init()};d.prototype={init:function(){var e=this,a=t("body").find("#"+e.options.modalId);if(e.options.$obj){var n=e.options.$obj.find("#"+e.options.modalWrapId+e.options.groupKey);return 0==n.length&&e.options.showForm&&"flat"==e.options.showForm&&(e.buildFlat(),e.loadSmartGroupModal()),e}return 0==a.length&&(e.buildModal(),e.tabClosePop()),e},buildFlat:function(){var t=this,e=t.options.$obj.append(t.modalBody()),a=e.find("#"+t.options.modalWrapId+t.options.groupKey);a.smartGroupFilter({scene:t.options.scene,func:t.options.func,groupKey:t.options.groupKey}),a.append(t.createDataTable()),t.addTableData()},tabClosePop:function(){var e;t(".sg-tabs-container .nav li").on("click",function(){var a=t(this).index();e&&e!=a&&t("body").smartGroupFilter().closePopFun(),e=a})},loadSmartGroupModal:function(){var t=this;SMARTGROUP.getSmartGroup({data:t.options.groupKey},function(){var t,e=JSON.parse(this.data.content),a=[];if(e){i=e.shift(),l=e.pop();for(var n=0;n<e.length;n++){var d=e[n].childrenItem;if(d&&d.length>0){t=d.length-1;for(var s=0;s<d.length;s++)d[s].count=0==s?e[n].count:d[s].count,d[s].index=e[n].index+s,a.push(d[s]);n++}e[n].index=t?e[n].index+t:e[n].index,a.push(e[n])}}o&&o.rows.add(a).draw()})},show:function(){var e=this;t("#"+e.options.modalId).modal("show"),e.loadSmartGroupModal()},hide:function(){var e=this;t("#"+e.options.modalId).modal("hide"),o.clear().draw()},buildModal:function(){var e=this,a=t(e.modalWrap()),n=a.find(".modal-content");n.append(e.modalHeader()),n.append(e.modalBody()),n.append(e.modalBtn());var o=t("body").append(a),i=o.find("#"+e.options.modalWrapId+e.options.groupKey);i.empty(),i.smartGroupFilter({scene:e.options.scene,func:e.options.func,groupKey:e.options.groupKey}),i.append(e.createDataTable()),e.addTableData(),o.find("#"+e.options.modalOkId).on("click",function(){e.smartGroupModalOk()}),o.find("#"+e.options.modalCancelId).on("click",function(){e.hide(),e.options.btnCancelModalHide&&e.options.btnCancelModalHide.modal("show")})},modalWrap:function(){var t=this;return'<div class="modal" id="'+t.options.modalId+'" role="dialog" aria-hidden="true"><div class="modal-dialog"><div class="modal-content sg-content"></div></div></div>'},modalHeader:function(){var t=this;return'<div class="modal-header"><button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button><h4 class="modal-title">'+t.options.modalTitle+"</h4></div>"},modalBody:function(){var t=this;return'<div class="modal-body sg-modal-body"><div class="clearfix" id="'+t.options.modalWrapId+t.options.groupKey+'"></div></div>'},modalBtn:function(){var t=this;return'<div class="modal-footer"><button id="'+t.options.modalOkId+'" class="btn btn-info">'+t.options.modalOk+'</button><button id="'+t.options.modalCancelId+'" class="btn btn-default" data-dismiss="modal">'+t.options.modalCancel+"</button></div>"},createDataTable:function(){var t=this;return'<table class="table row-bordered table-hover" id="'+t.options.tableId+t.options.groupKey+'"></table>'},smartGroupModalSave:function(e){var a=this,n=o.data(),d=[i];if(n){var s=n.length;l.index=s+1;for(var r=0;s>r;r++){var c=t.extend(n[r],a.options.extendData,{index:r+1});d.push(c)}d.push(l)}SMARTGROUP.updateSmartGroup({content:JSON.stringify(d),key:e})},smartGroupModalOk:function(){var t=this;"function"==typeof t.options.modalOkFunc&&t.options.modalOkFunc(),t.smartGroupModalSave(t.options.groupKey),t.hide()},addTableData:function(){var e=this;o=t("#"+e.options.tableId+e.options.groupKey).DataTable({stateSave:!0,aLengthMenu:[5,10],iDeferLoading:5,searching:!1,ordering:!1,tableTools:{sSwfPath:"js/plugins/dataTables/swf/copy_csv_xls_pdf.swf"},language:{url:"/localisation/dataTables/zh-cn.json"},columns:[{title:"类型",data:"iClass",render:function(t,e,a,n){return'<i class="fa '+t+'"></i>'}},{title:"条件",data:"text"},{title:"数量",data:"count"},{title:"操作",data:"id",render:function(t,e,a,n){return'<button class="btn btn-white btn-xs" name="btnDelOp" data-id="'+t+'" title="删除" ><i class="fa fa-trash"></i></button>'}}]}),o.on("draw.dt",function(a,n,i,l){t(this).find("button[name=btnDelOp]").off().on("click",function(){var a=t(this);swal({title:TxtContent.isDel,type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:TxtContent.confirm,cancelButtonText:TxtContent.cancel},function(){SMARTGROUP.delSmartGroupNode({data:a.data("id")},function(){o.row(a.parents("tr")).remove().draw(),(new d).smartGroupModalSave(e.options.groupKey)})})})})},getParentId:function(){var t="",e=o.data(),a=e.length;return t=e&&a>0?e[a-1].id:"parentId"}},t.fn.smartGroupModal=function(t){var e=this,a=new d(t);return e.on("click",function(){a.show()}),e},e.SGTableModal||(e.SGTableModal=d)}(jQuery,window,document),function(){$("li.showLi").on("click",function(){var t=$(this),e=$(".customTab",t).attr("href");t.addClass("active").siblings("li").removeClass("active"),$(e).addClass("active").siblings("div").removeClass("active")})}();var lvData=PLAT.listLevel(),createLvModule=function(t,e,a){var n=$('<div class="col-lg-3 LvModule" id="'+a+'" data-id="'+a+'"></div>'),o=$('<div class="ibox float-e-margins"></div>').appendTo(n),i=$('<div class="ibox-title"><h5 class="level-name">'+t+"</h5></div>"),l=$('<div class="ibox-content"><h1 class="no-margins">896,250</h1><span class="stat-percent font-bold text-danger delLv"><i class="fa fa-trash"></i></span><span class="stat-percent font-bold text-info editorLv"><i class="fa fa-pencil"></i></span><small title="'+e+'" class="descLv">TxtContent.levelSetting.lvDes</small></div>');return o.append(i,l),$("#LvRow").append(n),n},bindLvModule=function(t,e,a){var n=createLvModule(t,e,a),o=function(){var t=$(".level-name",n).text(),e=$(".descLv",n).attr("title");editorLevelModal.show(),editorLevelModal.setValue("baseDataValue",t),editorLevelModal.setValue("desc",e),editorLevelModal.setValue("key",a)};return n.off().on("dblclick",function(){o()}),$(".editorLv",n).on("click",function(){o()}),$(".delLv",n).on("click",function(){XREWIN.confirmModal("",function(){PLAT.delLevel(n.data("id"),function(){n.remove(),$("#configContent").empty()})})}),$(".ibox-title",n).off().on("click",function(){var t=n.data("id");$(".LvModule").removeClass("curSettingLv"),n.addClass("curSettingLv"),PLAT.getLevelSetting({key:t},function(){var e=this.data,a=$("#brandConfig");n.hasClass("curSettingLv")?(a.attr("disabled",!1).removeClass("borderColor"),a.off().on("click",function(){var e=new FormModal(brandParam());e.refreshValue("brand",PLAT.getBrandListByLevel(t)),e.show()})):a.attr("disabled",!0).addClass("borderColor");var o=$("#configContent");if(o.empty(),e.length>0)for(var i=0;i<e.length;i++)createLvConfig(t,e[i].brandKey,e[i].brandTxt,e[i].groupKey);else o.empty();$("#navLv").find("li:eq(0) a").tab("show")})}),n},editorLevelParam={id:"editor-Level",title:TxtContent.levelSetting.title,elements:[{require:!0,labelName:TxtContent.levelSetting.name,type:"text",name:"baseDataValue"},{labelName:TxtContent.levelSetting.lvDes,type:"textarea",name:"desc"},{type:"hidden",name:"key"}],submitBindFunc:function(t,e){var a=this,n=a.getValue("key"),o=a.getValue("baseDataValue"),i=a.getValue("desc"),l=$("#"+n);PLAT.updateLevel(e,function(){$(".level-name",l).text(o),$(".descLv",l).attr("title",i)})},clear:!0},editorLevelModal=new FormModal(editorLevelParam),addLevelParam={id:"add-Level",title:TxtContent.levelSetting.addLv,elements:[{require:!0,labelName:TxtContent.levelSetting.name,type:"text",name:"baseDataValue"},{labelName:TxtContent.levelSetting.lvDes,type:"textarea",name:"desc"}],submitBindFunc:function(t,e){var a=this,n=a.getValue("baseDataValue"),o=a.getValue("desc");n&&PLAT.addLevel(e,function(){var t=this.data;bindLvModule(n,o,t)})},clear:!0};if($("#addLevel").popup(addLevelParam),lvData&&lvData.length>0)for(var i=0;i<lvData.length;i++){var module=bindLvModule(lvData[i].baseDataValue,lvData[i].desc,lvData[i].key);1==lvData[i].isDefault&&($(".delLv",module).remove(),$(".editorLv",module).remove(),$(".ibox-title",module).off("click"))}var createLvConfig=function(t,e,a,n){var o=$("#navLv"),i=$("#navConLv");0==o.length&&0==i.length&&(o=$('<ul class="nav nav-tabs" id="navLv"></ul>'),i=$('<div class="tab-content" id="navConLv"></div>'));var l=$('<li data-brand_key="'+e+'" data-lv_key="'+t+'"><span class="badge badge-warning pull-right delNav">x</span><a data-toggle="tab" href="#'+n+'">'+a+"</a></li>").appendTo(o),d=$('<div id="'+n+'" class="tab-pane"><div class="panel-body"></div></div>').appendTo(i);return $("#configContent").append(o,i),$(".delNav",l).off().on("click",function(t){var e=$(this).parent("li"),a=XREWIN.FormData({key:e.data("lv_key"),brandKeys:e.data("brand_key")});PLAT.removeLevelSetting(a,function(){l.remove(),d.remove()}),t.stopPropagation()}),$("li a",o).off().on("shown.bs.tab",function(){$(".tab-pane .panel-body",i).empty();var t=$(this),e=t.attr("href");new SGTableModal({groupKey:e.replace("#",""),showForm:"flat",$obj:$(".panel-body",$(e))})}),$("a",l)},brandParam=function(){return{id:"brandParam",title:brandConfig,elements:[{require:!0,type:"select",name:"brand",labelName:TxtContent.levelSetting.brand,selectOptions:{multiple:"multiple",optionData:[]}}],submitBindFunc:function(t,e){var a="",n=t.find("select[name=brand] option:selected");n.each(function(){a+=$(this).text()+"　"}),e.append("brandTxt",a);var o=t.find("select[name=brand]").val(),i="";$.isArray(o)?(i=o.join(),e.append("brandKeys",i)):(i=o,e.append("brandKeys",i));var l=$(".curSettingLv").data("id");e.append("key",l),PLAT.getGroupKeyByLevel(e,function(){var t=this.data,e=createLvConfig(l,i,a,t);e.tab("show")})},clear:!0}};$("#navMenuBox").menu(subsetMenu);